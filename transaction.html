<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinTrack â€“ All Transactions</title>

    <style>
        * { margin:0; padding:0; box-sizing:border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu;
            background:#f5f7fa;
            color:#1a202c;
        }

        .container {
            display:flex;
            min-height:100vh;
        }

        /* Sidebar (fixed version) */
.sidebar {
    width:255px;
    background:white;
    border-right:1px solid #e2e8f0;
    padding:24px;
    display:flex;
    flex-direction:column;
}

.logo {
    display:flex;
    align-items:center;
    gap:12px;
    margin-bottom:40px;
}

.logo-icon {
    width:40px;
    height:40px;
    background:#5b5ff5;
    border-radius:12px;
}

.logo-text {
    font-size:20px;
    font-weight:700;
}


        .nav-menu { list-style:none; margin-bottom:auto; }
        .nav-item { margin-bottom:8px; }

        .nav-link {
            display:flex;
            align-items:center;
            gap:12px;
            padding:12px 16px;
            text-decoration:none;
            color:#64748b;
            border-radius:8px;
            transition:0.2s;
            font-size:15px;
        }

        .nav-link:hover, .nav-link.active {
            background:#f1f3ff;
            color:#5b5ff5;
            font-weight:500;
        }

        /* Main Content */
        .main-content {
            flex:1;
            padding:32px;
            overflow-y:auto;
        }

        .header {
            margin-bottom:35px;
        }

        .header h1 {
            font-size:32px;
            font-weight:700;
            margin-bottom:5px;
        }

        .header-subtitle {
            color:#64748b;
            font-size:15px;
        }

        /* Transactions List */
        .transactions-container {
            background:white;
            padding:24px;
            border-radius:12px;
            border:1px solid #e2e8f0;
        }

.transaction-row {
    display: grid;
    grid-template-columns: 1fr 150px 150px 120px 100px;  /* Added Action column */
    padding: 16px 0;
    border-bottom: 1px solid #f1f5f9;
    font-size: 15px;
    align-items: center;   /* Vertically align items */
}


        .transaction-row:last-child {
            border-bottom:none;
        }

        .amount-pos { color:#10b981; font-weight:600; }
        .amount-neg { color:#ef4444; font-weight:600; }

.filter-bar {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    margin-bottom: 10px;
    gap: 10px;
}

.filter-bar label {
    font-weight: 600;
}

.filter-bar select {
    padding: 8px 12px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 15px;
}





    </style>
</head>

<body>

<div class="container">

    <!-- SIDEBAR -->
    <aside class="sidebar">
        <div class="logo">
            <span class="logo-text">FinTrack</span>
        </div>

        <ul class="nav-menu">
            <li><a href="index.HTML" class="nav-link">Dashboard</a></li>
            <li><a href="transaction.html" class="nav-link active">Transactions</a></li>
        </ul>
    </aside>
    

    <!-- MAIN CONTENT -->
    <main class="main-content">
        <div class="filter-bar">
    <label>Filter by Category:</label>
    <select id="categoryFilter">
        <option value="all">All</option>
        <option value="Food">Food</option>
        <option value="Transportation">Transportation</option>
        <option value="Entertainment">Entertainment</option>
        <option value="Shopping">Shopping</option>
        <option value="Bills">Bills</option>
        <option value="Health">Health</option>
        <option value="Other">Other</option>
    </select>
</div>

        <div class="header">
            <h1>All Transactions</h1>
            <p class="header-subtitle">View your complete transaction history</p>
        </div>

        <div class="transactions-container">
            <!-- Table Header -->
            <div class="transaction-row" style="font-weight:600; color:#64748b;">
                <span>Description</span>
                <span>Category</span>
                <span>Date</span>
                <span>Amount</span>
                <span>Action</span>
            </div>
        </div>

    </main>
</div>



<script>

let allTransactions = []; // stored for filtering

// Load transactions once
fetch("https://fintracker-mb74.onrender.com/transactions")
    .then(res => res.json())
    .then(transactions => {
        allTransactions = transactions;
        displayTransactions(transactions);
    });

// Function to display transactions
function displayTransactions(transactions) {
    const list = document.querySelector(".transactions-container");

    // Clear container but keep header row
    list.innerHTML = `
        <div class="transaction-row" style="font-weight:600; color:#64748b;">
            <span>Description</span>
            <span>Category</span>
            <span>Date</span>
            <span>Amount</span>
            <span>Action</span>
        </div>
    `;

    // Add filtered items
    transactions.forEach(tx => {
        const row = document.createElement("div");
        row.className = "transaction-row";

        row.innerHTML = `
            <span>${tx.description}</span>
            <span>${tx.category}</span>
            <span>${tx.date.split("T")[0]}</span>
            <span class="${tx.type === 'income' ? 'amount-pos' : 'amount-neg'}">
                ${tx.type === 'income' ? '+' : '-'}$${parseFloat(tx.amount).toFixed(2)}
            </span>
            <span>
                <button onclick="deleteTransaction(${tx.id}, this)"
                    style="padding:6px 12px; background:#ef4444; color:white; border:none; border-radius:6px; cursor:pointer;">
                    Delete
                </button>
            </span>
        `;

        list.appendChild(row);
    });
}

// Filter logic
document.getElementById("categoryFilter").addEventListener("change", function() {
    const selected = this.value;

    if (selected === "all") {
        displayTransactions(allTransactions);
    } else {
        const filtered = allTransactions.filter(tx => tx.category === selected);
        displayTransactions(filtered);
    }
});


function deleteTransaction(id, buttonElement) {
    if (!confirm("Are you sure you want to delete this transaction?")) return;

    fetch(`https://fintracker-mb74.onrender.com/transaction/${id}`, {
        method: "DELETE"
    })
    .then(res => res.json())
    .then(data => {
        console.log(data);

        // Remove from array
        allTransactions = allTransactions.filter(tx => tx.id !== id);

        // Refresh display
        displayTransactions(allTransactions);
    });
}

</script>



</body>
</html>

